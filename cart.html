<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f3f3f3;
            margin: 0;
            padding: 0;
        }
    
        header {
            background-color: #131921;
            color: #fff;
            padding: 15px;
        }
    
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
    
        .cart-item {
            display: flex;
            border: 1px solid #e7e7e7;
            background-color: #fff;
            margin-bottom: 20px;
            padding: 15px;
        }
    
        .cart-item img {
            max-width: 100px;
            max-height: 100px;
            margin-right: 20px;
        }
    
        .item-details {
            flex: 1;
        }
    
        .item-title {
            font-size: 18px;
            font-weight: 600;
        }
    
        .item-price {
            color: #b12704;
            font-size: 20px;
            font-weight: 600;
        }
    
        .quantity {
            display: flex;
            align-items: center;
        }
    
        .quantity button {
            background-color: #f3f3f3;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    
        .quantity input {
            width: 40px;
            text-align: center;
            font-size: 16px;
        }
    
        .subtotal {
            text-align: right;
        }
    
        .subtotal p {
            font-size: 18px;
            font-weight: 600;
        }
    
        .checkout-button {
            background-color: #f0c14b;
            color: #111;
            border: none;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
        }
    
        .checkout-button:hover {
            background-color: #d3ad35;
        }
         /* Responsive styles */
    @media (max-width: 768px) {
        .container {
            padding: 10px;
        }

        .cart-item {
            flex-direction: column;
        }

        .cart-item img {
            max-width: 100%;
            margin-right: 0;
            margin-bottom: 10px;
        }

        .item-details {
            width: 100%;
        }
        .quantity button {
            padding: 5px;
        }

        .quantity input {
            width: 30px;
        }

        .checkout-button {
            font-size: 16px;
        }
    }
    </style>
    
</head>

<body>
    <header>
        <div class="container">
            <h1>Your Cart</h1>
        </div>
    </header>

    <div class="container" id="parent">
        <!-- Cart items will be added dynamically here using JavaScript -->
    </div>

    <script>
         const quantityMap = {}; 

async function fetchData() {
    const response = await fetch('https://bicycle-shop-json-server.cyclic.app/bikes');
    const data = await response.json();
    return data;
}

// Function to update the price and subtotal
function updatePriceAndSubtotal(item, quantityElement, priceElement, subtotalElement) {
    const price = item.price;
    const quantity = quantityMap[item.id]; 

    // Update the item's price
    priceElement.textContent = '$' + (price * quantity).toFixed(2);

    // Update the subtotal
    subtotalElement.textContent = '$' + (price * quantity).toFixed(2);
}

async function renderCart() {
    const data = await fetchData();
    var parent = document.getElementById("parent");

    if (data.length === 0) {
        parent.textContent = "Cart Empty";
        var buttontxt = document.createElement('button');
        buttontxt.textContent = "Keep Shopping";
        parent.append(buttontxt);
    } else {
        data.forEach((item) => {
            var cartItem = document.createElement('div');
            cartItem.classList.add('cart-item');
            cartItem.id = item.id;

            var img = new Image();
            img.src = item.large_img;

            var itemDetails = document.createElement('div');
            itemDetails.classList.add('item-details');

            var itemTitle = document.createElement('p');
            itemTitle.classList.add('item-title');
            itemTitle.textContent = item.title;

            var itemPrice = document.createElement('p');
            itemPrice.classList.add('item-price');
            itemPrice.textContent = '$' + item.price.toFixed(2);

            var quantity = document.createElement('div');
            quantity.classList.add('quantity');

            var decreaseButton = document.createElement('button');
            decreaseButton.textContent = '-';
            var quantityInput = document.createElement('input');
            quantityInput.type = 'text';
            quantityInput.value = '1';
            var increaseButton = document.createElement('button');
            increaseButton.textContent = '+';

            quantity.append(decreaseButton, quantityInput, increaseButton);

            var subtotal = document.createElement('div');
            subtotal.classList.add('subtotal');

            var subtotalPrice = document.createElement('p');
            subtotalPrice.textContent = '$' + item.price.toFixed(2);

            subtotal.append(subtotalPrice);

            itemDetails.append(itemTitle, itemPrice, quantity);
            cartItem.append(img, itemDetails, subtotal);
            parent.append(cartItem);

            // Attach click event handlers to +/- buttons
            decreaseButton.addEventListener('click', () => {
                let quantity = quantityMap[item.id];
                if (quantity > 1) {
                    quantity -= 1;
                    quantityMap[item.id] = quantity;
                    quantityInput.value = quantity;
                    updatePriceAndSubtotal(item, quantityInput, itemPrice, subtotalPrice);
                }
            });

            increaseButton.addEventListener('click', () => {
                let quantity = quantityMap[item.id];
                quantity += 1;
                quantityMap[item.id] = quantity;
                quantityInput.value = quantity;
                updatePriceAndSubtotal(item, quantityInput, itemPrice, subtotalPrice);
            });

            // Initialize quantity with a default quantity of 1 for each item
            quantityMap[item.id] = 1;

            // Initial price and subtotal calculation
            updatePriceAndSubtotal(item, quantityInput, itemPrice, subtotalPrice);
        });

        // Checkout button
        var checkoutButton = document.createElement('button');
        checkoutButton.classList.add('checkout-button');
        checkoutButton.textContent = 'Proceed to Checkout';
        parent.append(checkoutButton);
    }
}

renderCart();
    </script>
</body>

</html>
